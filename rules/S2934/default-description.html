<div class="paragraph">
<p>While the properties of a <code>readonly</code> reference type field can still be changed after initialization, those of a <code>readonly</code> value field, such as a <code>struct</code>, cannot.</p>
</div>
<div class="paragraph">
<p>If the member could be either a <code>class</code> or a <code>struct</code> then assignment to its properties could be unreliable, working sometimes but not others.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>interface IPoint
{
  int X { get; set; }
  int Y { get; set; }
}

class PointManager&lt;T&gt; where T: IPoint
{
  readonly T point;  // this could be a struct
  public PointManager(T point)
  {
    this.point = point;
  }

  public void MovePointVertically(int newX)
  {
    point.X = newX; //Noncompliant; if point is a struct, then nothing happened
    Console.WriteLine(point.X);
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>interface IPoint
{
  int X { get; set; }
  int Y { get; set; }
}

class PointManager&lt;T&gt; where T : IPoint
{
  readonly T point;  // this could be a struct
  public PointManager(T point)
  {
    this.point = point;
  }

  public void MovePointVertically(int newX) // assignment has been removed
  {
    Console.WriteLine(point.X);
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>interface IPoint
{
  int X { get; set; }
  int Y { get; set; }
}

class PointManager&lt;T&gt; where T : class, IPoint
{
  readonly T point;  // this can only be a class
  public PointManager(T point)
  {
    this.point = point;
  }

  public void MovePointVertically(int newX)
  {
    point.X = newX;  // this assignment is guaranteed to work
    Console.WriteLine(point.X);
  }
}</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Restrict "x" to be a reference type or remove this assignment of "y"; it is useless if "x" is a value type.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_13_may_2015_201312_ann_campbell_wrote">on 13 May 2015, 20:13:12 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk]</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I&#8217;ve got the name of the equivalent R# rule, but I&#8217;m not sure how to find its key&#8230;&#8203;</p>
</li>
<li>
<p>I suspect I may have missed some of the subtleties intended in this rule. Feel free to start an edit iteration</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_18_may_2015_091533_tamas_vajk_wrote">on 18 May 2015, 09:15:33 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>Updated the rule. Could you please check its language, and if it makes sense to you too?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_may_2015_143422_ann_campbell_wrote">on 21 May 2015, 14:34:22 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>see what you think [~tamas.vajk]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_may_2015_112816_tamas_vajk_wrote">on 22 May 2015, 11:28:16 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>Looks good, I adjusted some wording in the first sentence of the description</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_may_2015_121014_ann_campbell_wrote">on 22 May 2015, 12:10:14 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~tamas.vajk]. Looks good</p>
</div>
</div>
</div>
</div>