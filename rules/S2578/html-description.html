<div class="paragraph">
<p>In cross-site scripting attacks, attackers insert attack scripts into your pages. Because no system is fool-proof, it may not be enough to screen the data that&#8217;s submitted to an application. You should also escape any content sent to the user so that any malicious code that may have escaped your input screening is neutralized. Specifically, the characters crucial to forming HTML (<code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code>, <code>"</code>, <code>'</code>, and <code>/</code>) must be escaped.</p>
</div>
<div class="paragraph">
<p>This rule checks that values are not written directly into <code>application/json</code> blocks or JavaScript variables.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>&lt;script id="data" type="application/json"&gt;
  &lt;%= data.json_payload %&gt;  // Noncompliant
&lt;script&gt;

&lt;script&gt;
  var initialData = &lt;%= data.json_payload =&gt;;  // Noncompliant
&lt;/script&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>&lt;script id="data" type="application/json"&gt;
  &lt;c:out value="${data.json_payload}"&gt;  // by default, escapeXML="true" but it can also be specified explicitly
&lt;script&gt;

&lt;script&gt;
  var initialData = &lt;%= escape_html(data.json_payload) =&gt;;
&lt;/script&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection</p>
</li>
<li>
<p><a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet</a></p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site Scripting (XSS)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/79.html">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/352.html">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF)</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Escape "xxx".</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_6_feb_2015_192301_ann_campbell_wrote">on 6 Feb 2015, 19:23:01 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Assigned to you, at [~massimo.paladin] for initial vetting.</p>
</div>
</div>
</div>
</div>