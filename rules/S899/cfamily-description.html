<div class="paragraph">
<p>When the return value of a function call contains the operation status code, this value should be tested to make sure the operation completed successfully.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>// header.h
int add(int, int);

// file.c
#include header.h

void func(int n, int m) {
  // ...
  add(n,m);  // Noncompliant</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>// header.h
int add(int, int);

// file.c
#include header.h

void func(int n, int m) {
  // ...
  int q = add(n,m);

  if (add(n,m) &gt; 10) { // also compliant
    // ...
  }</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C:2004, 16.10 - If a function returns error information, then that error information shall be tested</p>
</li>
<li>
<p>MISRA C&#43;&#43;:2008, 0-1-7 - The value returned by a function having a non-void return type that is not an overloaded operator shall always be used.</p>
</li>
<li>
<p>MISRA C:2012, Dir. 4.7 - If a function returns error information, then that error information shall be tested</p>
</li>
<li>
<p>MISRA C:2012, 17.7 - The value returned by a function having non-void return type shall be used</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/kNYxBQ">CERT, ERR33-C.</a> - Detect and handle standard library errors</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/MdUxBQ">CERT, POS54-C.</a> - Detect and handle POSIX library errors</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/mtYxBQ">CERT, EXP12-C.</a> - Do not ignore values returned by functions</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/754.html">MITRE, CWE-754</a> - Improper Check for Unusual Exceptional Conditions</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Do something with the "type" value returned by "xxx"</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s2201">is related to: S2201</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s2677">is related to: S2677</h3>

</div>
<div class="sect2">
<h3 id="_on_13_nov_2014_225527_evgeny_mandrikov_wrote">on 13 Nov 2014, 22:55:27 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>There is some exclusions in CERT.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_nov_2014_161615_ann_campbell_wrote">on 17 Nov 2014, 16:16:15 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov] do you want to add a whitelist to this rule?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_feb_2015_203428_sébastien_gioria_wrote">on 2 Feb 2015, 20:34:28 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This could fall into OWASP Top10 2013 -A6</p>
</div>
<div class="paragraph">
<p>it&#8217;s CERT EXP00-J</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_202649_ann_campbell_wrote">on 3 Feb 2015, 20:26:49 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I&#8217;ve added the CERT reference [~sebastien.gioria], but don&#8217;t understand the OWASP tie.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_202847_ann_campbell_wrote">on 3 Feb 2015, 20:28:47 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] the history on this ticket shows that you deleted the description on the 1st of December. How come?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_feb_2015_094511_freddy_mallet_wrote">on 4 Feb 2015, 09:45:11 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I guess my main goal was to remove the Compliant and NonCompliant sections that were suitable only for C/C&#43;&#43;. But indeed the first sentence should remain in the global description. I let you revert this change @Ann ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jul_2016_095915_freddy_mallet_wrote">on 29 Jul 2016, 09:59:15 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2], I tend to think that the impact should be "Low" on this vulnerability.</p>
</div>
</div>
</div>
</div>