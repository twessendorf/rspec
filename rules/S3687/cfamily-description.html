<div class="paragraph">
<p>The main intended use-case for <code>volatile</code> in C and C&#43;&#43; is to access data that can be modified by something external to the program, typically some hardware register. In contrast with other languages that provide a <code>volatile</code> keyword, it does not provide any useful guarantees related to atomicity, memory ordering, or inter-thread synchronization. It is only really needed for the kind of low-level code found in kernels or embedded software, i.e. using memory-mapped I/O registers to manipulate hardware directly.</p>
</div>
<div class="paragraph">
<p>According to the C standard:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><code>volatile</code> is a hint to the implementation to avoid aggressive optimization involving the object because the value of the object might be changed by means undetectable by an implementation.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Only C11/C&#43;&#43;11 "atomic types" are free from data races, and you should use them or synchronization primitives if you want to avoid race conditions.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when a local variable or class data member is declared as <code>volatile</code> (at the top level of the type, pointers to volatile are not reported).</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>volatile int counter; // Noncompliant
User * volatile vpUser; // Noncompliant; pointer is volatile
User volatile * pvUser;  // Compliant; User instance is volatile, not the pointer</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>atomic_int counter;
std::atomic&lt;User*&gt; vpUser;
User volatile * pvUser;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/display/c/CON02-C.+Do+not+use+volatile+as+a+synchronization+primitive">CERT CON02-C</a> - Do not use volatile as a synchronization primitive</p>
</li>
<li>
<p><a href="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#cp200-use-volatile-only-to-talk-to-non-c-memory">C&#43;&#43; Core Guidelines CP.200</a> - Use volatile only to talk to non-C&#43;&#43; memory</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Convert this "volatile" type into an atomic type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>volatile keyword</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s3475">is related to: S3475</h3>

</div>
<div class="sect2">
<h3 id="_on_27_jul_2016_154926_ann_campbell_wrote">on 27 Jul 2016, 15:49:26 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Okay [~alban.auzeill], double-check me.</p>
</div>
</div>
</div>
</div>