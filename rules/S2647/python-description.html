<div class="paragraph">
<p>Basic authentication&#8217;s only means of obfuscation is Base64 encoding. Since Base64 encoding is easily recognized and reversed, it offers only the thinnest veil of protection to your users, and should not be used.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.python.org/3/library/urllib.request.html">urllib.request</a> library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import urllib.request

authenticationHandler = urllib.request.HTTPBasicAuthHandler()        # Noncompliant
authenticationHandler.add_password(None,
                                      'http://www.sonarsource.com/',
                                      'sonaruser',
                                      'secretpass1!')
opener = urllib.request.build_opener(authenticationHandler)
urllib.request.install_opener(opener)

urllib.request.urlopen('http://www.sonarsource.com/credential.html')</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://httplib2.readthedocs.io/en/latest/">httplib2</a> library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import httplib2

conn = httplib2.Http(".cache")
conn.add_credentials('sonaruser', 'secretpass1!')
response, content = conn.request("http://www.sonarsource.com/rest/path", "GET")       # Noncompliant</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://requests.readthedocs.io/en/master/">requests</a> library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import requests

conn = requests.get('http://www.sonarsounce.com/rest/path', auth=('sonaruser', 'secretpass1!'))   # Noncompliant</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.python.org/3/library/http.client.html">http.client</a> library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>from http.client import HTTPConnection
from base64 import b64encode

conn = HTTPConnection('www.sonarsource.com')
credential = b64encode(b'sonaruser:secretpass1!').decode('ascii')
conn.request('GET', '/', headers={'Authorization': 'Basic %s' % credential})      # Noncompliant</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A4</a> - Insecure Design</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication">OWASP Web Service Security Cheat Sheet</a></p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/522.html">MITRE, CWE-522</a> - Insufficiently Protected Credentials</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a more secure method than basic authentication.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_085423_nicolas_peru_wrote">on 8 Jun 2015, 08:54:23 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I was a little confused at first by the starting of the first sentence and thought you got the title of the rule wrong. I would rewrite this sentence like : "Basic authentication uses Base64 as&#8230;&#8203; "</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_121452_ann_campbell_wrote">on 8 Jun 2015, 12:14:52 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Better [~nicolas.peru]?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_121842_nicolas_peru_wrote">on 8 Jun 2015, 12:18:42 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Looks good ! :)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jan_2019_110648_alexandre_gigleux_wrote">on 23 Jan 2019, 11:06:48 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>Reference HttpPost: http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_dec_2019_104759_alexandre_gigleux_wrote">on 2 Dec 2019, 10:47:59 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>I remove CWE-311 from this rule because CWE-311 maps to "INSECURE_CONF" SonarSource Security Category and this makes this RSPEC mapping to 2 SonarSource Security Category and we expect a given RSPEC to map to only one specific SonarSource Security Category.</p>
</div>
</div>
</div>
</div>