<div class="paragraph">
<p>In cross-site scripting attacks, attackers insert attack scripts into your pages. Because no system is fool-proof, it may not be enough to screen the data that&#8217;s submitted to an application. You should also escape any content sent to the user so that any malicious code that may have escaped your input screening is neutralized. Specifically, the characters crucial to forming HTML must be escaped:</p>
</div>
<div class="paragraph">
<p>||turn||into||</p>
</div>
<div class="paragraph">
<p>|&amp;|&amp;amp;|</p>
</div>
<div class="paragraph">
<p>|&lt;|&amp;lt;|</p>
</div>
<div class="paragraph">
<p>|&gt;|&amp;gt;|</p>
</div>
<div class="paragraph">
<p>|"|&amp;quot;|</p>
</div>
<div class="paragraph">
<p>|'|&amp;#x27;|</p>
</div>
<div class="paragraph">
<p>|/|&amp;#x2F;|</p>
</div>
<div class="paragraph">
<p>This rule raises an issue for anything sent to <code>WEB</code>.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>...
EXEC SQL
  SELECT NAME
  INTO :PNAME
  FROM PRODUCT
  WHERE ID = :PRODUCT_ID
END-EXEC.

EXEC CICS
  WEB SEND  *&gt; Noncompliant
  FROM(PNAME)
  *&gt; ...
END-EXEC.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site Scripting (XSS)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/79.html">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/80.html">MITRE, CWE-80</a> - Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/352.html">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF)</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_5_feb_2015_200800_ann_campbell_wrote">on 5 Feb 2015, 20:08:00 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>In the WebGoat project, one of the exercises is to inject a script into a value that&#8217;s then stored in the database, and the point of the lesson is to escape outgoing values.</p>
</div>
<div class="paragraph">
<p>Also: https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet#RULE_.231_-_HTML_Escape_Before_Inserting_Untrusted_Data_into_HTML_Element_Content</p>
</div>
<div class="paragraph">
<p>This rule may need a sort of whitelist parameter: i.e. ignore values that have been passed through x method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_feb_2015_202209_ann_campbell_wrote">on 5 Feb 2015, 20:22:09 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>We may also need to narrow the scope of this some. Perhaps to values retrieved from external sources, e.g. file, database, etc&#8230;&#8203;?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_jul_2015_074030_ann_campbell_wrote">on 20 Jul 2015, 07:40:30 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Tagged java-top by Ann</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_sep_2015_095721_ann_campbell_wrote">on 21 Sep 2015, 09:57:21 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~michael.gumowski] I&#8217;ve updated this rule mostly as discussed, but added another source of data to check: parameters</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_sep_2019_174318_alexandre_gigleux_wrote">on 23 Sep 2019, 17:43:18 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>This rule is corresponding to Stored XSS. I&#8217;m closing it for now as it will be covered by a more generic RSPEC similarly to what we did for Reflected XSS (RSPEC-5131).</p>
</div>
</div>
</div>
</div>