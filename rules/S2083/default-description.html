<div class="paragraph">
<p>User provided data, such as URL parameters, POST data payloads, or cookies, should always be considered untrusted and tainted. Constructing file system paths directly from tainted data could enable an attacker to inject specially crafted values, such as <code>'../'</code>, that change the initial path and, when accessed, resolve to a path on the filesystem where the user should normally not have access.</p>
</div>
<div class="paragraph">
<p>A successful attack might give an attacker the ability to read, modify, or delete sensitive information from the file system and sometimes even execute arbitrary operating system commands. This is often referred to as a "path traversal" or "directory traversal" attack.</p>
</div>
<div class="paragraph">
<p>The mitigation strategy should be based on the whitelisting of allowed paths or characters.</p>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A1-Injection">OWASP Top 10 2017 Category A1</a> - Injection</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/20.html">MITRE, CWE-20</a> - Improper Input Validation</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/22.html">MITRE, CWE-22</a> - Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/99.html">MITRE, CWE-99</a> - Improper Control of Resource Identifiers ('Resource Injection')</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/641.html">MITRE, CWE-641</a> - Improper Restriction of Names for Files and Other Resources</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to not construct the path from user-controlled data.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s4797">relates to: S4797</h3>

</div>
<div class="sect2">
<h3 id="_on_2_oct_2014_081401_nicolas_peru_wrote">on 2 Oct 2014, 08:14:01 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>I have some doubt about that one as for instance in Java plugin code base I have the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>private File resolvePath(File baseDir, String fileName) {
    File file = new File(fileName);
    if (!file.isAbsolute()) {
      file = new File(baseDir, fileName);
    }
    return file;
  }</pre>
</div>
</div>
<div class="paragraph">
<p>Which is based on a property coming from SQ and filled by the user to be able to access libraries of a java project. So you actually <em>want</em> to support access to some files eventually located in relative directories&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_oct_2014_141234_ann_campbell_wrote">on 2 Oct 2014, 14:12:34 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] there are 2 CWE&#8217;s we&#8217;re covering here, one about absolute path traversal and another about relative traversal.</p>
</div>
<div class="paragraph">
<p>In any case, the point of your code is to read files on paths provided by the user. Since your code runs on the user&#8217;s machine, there&#8217;s no problem with that and I wouldn&#8217;t expect this rule to be activated. I&#8217;ll switch this to off by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_084009_nicolas_peru_wrote">on 8 Oct 2014, 08:40:09 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Probably easier with CFG.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_may_2018_120403_dinesh_bolkensteyn_wrote">on 14 May 2018, 12:04:03 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>FYI, I fail to understand your 4 years old comment [~nicolas.peru] - is it still relevant? feel free to delete it otherwise</p>
</div>
</div>
</div>
</div>