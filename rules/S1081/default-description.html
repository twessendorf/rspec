<div class="paragraph">
<p>When using typical C functions, it&#8217;s up to the developer to make sure the size of the buffer to be written to is large enough to avoid buffer overflows. Buffer overflows can cause the program to crash at a minimum. At worst, a carefully crafted overflow can cause malicious code to be executed.</p>
</div>
<div class="paragraph">
<p>This rule reports use of the following insecure functions, for which knowing the required size is not generally possible: <code>gets()</code> and <code>getpw()</code>.</p>
</div>
<div class="paragraph">
<p>In such cases. The only way to prevent buffer overflow while using these functions would be to control the execution context of the application.</p>
</div>
<div class="paragraph">
<p>It is much safer to secure the application from within and to use an alternate, secure function which allows you to define the maximum number of characters to be written to the buffer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fgets</code> or <code>gets_s</code></p>
</li>
<li>
<p><code>getpwuid</code></p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>gets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>gets_s(str, sizeof(str)); // Prevent overflows by enforcing a maximum size for `str` buffer</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> - Using Components with Known Vulnerabilities</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/676.html">MITRE, CWE-676</a> - Use of Potentially Dangerous Function</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/119.html">MITRE, CWE-119</a> - Improper Restriction of Operations within the Bounds of a Memory Buffer</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove the use of this insecure 'xxxxx' function.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1080">is duplicated by: S1080</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s6069">is related to: S6069</h3>

</div>
<div class="sect2">
<h3 id="_on_6_aug_2013_231226_ann_campbell_wrote">on 6 Aug 2013, 23:12:26 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Changed "unsecured" to "insecure".</p>
</div>
<div class="paragraph">
<p>Hope I interpreted it correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_072855_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 07:28:55 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Relates to ObsoletePosixFunction</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_073523_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 07:35:23 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Interesting reference of insecure functions: http://msdn.microsoft.com/en-us/library/bb288454.aspx</p>
</div>
</div>
</div>
</div>