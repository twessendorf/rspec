<div class="paragraph">
<p>Perhaps no one ever said "idle sessions are the devil&#8217;s workshop", but they should have. Sessions that users have abandoned are vulnerable to being hijacked. To keep the window of danger as small as possible, any application which authenticates users should also time them out after as small as practical a period of inactivity.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when session timeout is set higher than the provided value.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the default threshold of 15:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// web.xml
&lt;session-config&gt;
  &lt;session-timeout&gt;60&lt;/session-timeout&gt;  &lt;!-- Noncompliant  --&gt;
&lt;/session-config&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class MySessionListener implements HttpSessionListener{
  public void sessionCreated(HttpSessionEvent event){
    event.getSession().setMaxInactiveInterval(30*60);  // Noncompliant; 30 min &gt; 15
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>// web.xml
&lt;session-config&gt;
  &lt;session-timeout&gt;15&lt;/session-timeout&gt;
&lt;/session-config&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class MySessionListener implements HttpSessionListener{
  public void sessionCreated(HttpSessionEvent event){
    event.getSession().setMaxInactiveInterval(15*60);
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and Authentication Failures</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/613.html">MITRE, CWE-613</a> - Insufficient Session Expiration</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP, Session Management Cheat Sheet</a></p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Reduce to timeout from n to the allowed m minutes or less.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="ulist">
<ul>
<li>
<p>key = threshold</p>
</li>
<li>
<p>description: Maximum timeout allowed, in minutes</p>
</li>
<li>
<p>default: 15</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>primary: the number. E.G.  <code>&lt;session-timeout&gt;{color:red}60{color}&lt;/session-timeout&gt;</code></p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_155746_tomislav_nakic_alfirevic_wrote">on 4 Mar 2016, 15:57:46 Tomislav Nakic-Alfirevic wrote:</h3>
<div class="paragraph">
<p>Interesting: I need the exact opposite: we consider our office network a "safe" zone and see session timeouts and consequential login screens as unnecessary interruptions. The effect is similar, however: we too would like to have the duration of the session to be configurable.</p>
</div>
<div class="paragraph">
<p>For now, we have done this by directly editing web.xml, but this will be overwritten with the next upgrade, so a more permanent, set-and-forget solution would be welcome. Obviously a minor inconvenience, but I don&#8217;t imagine it requires too much effort to support, either.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_161424_ann_campbell_wrote">on 4 Mar 2016, 16:14:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tna] I understand where you&#8217;re coming from, but as devil&#8217;s advocate, I&#8217;m going to pose the following scenario: I&#8217;m working remotely because I&#8217;m on the road for (insert relevant scenario). I decide to stop at Starbucks to get a latte and check (something that would make me VPN in). And then I forget to lock my computer when I step away from my laptop to use the bathroom at Starbucks&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>Okay, maybe you don&#8217;t offer VPN access&#8230;&#8203; yet.</p>
</div>
<div class="paragraph">
<p>But you get my point.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_164502_tomislav_nakic_alfirevic_wrote">on 4 Mar 2016, 16:45:02 Tomislav Nakic-Alfirevic wrote:</h3>
<div class="paragraph">
<p>Hi Ann, thank&#8217;s for the quick comment. Indeed, I do get your point, but:</p>
</div>
<div class="paragraph">
<p>1) how probable is the sequence of events you&#8217;ve described (on the road, VPN connection on, logged into Sonar, leaves the machine without locking it&#8230;&#8203;), especially given that another very rare event has to happen, which is that there should be a malevolent person there who calmly sits down at your machine - in front of other customers! - and wreaks havoc on your Sonar instance&#8230;&#8203;?</p>
</div>
<div class="paragraph">
<p>2) extreme improbability aside, your scenario would lead to a security breach even without a configurable timeout, i.e. with current latest release of Sonar, because the way you described it, the default 20 minute-session would still be active and the bad guy could do his stuff as soon as you closed the bathroom door</p>
</div>
<div class="paragraph">
<p>3) the default value is completely arbitrary (there&#8217;s nothing special about the value "20 minutes"&#8230;&#8203;), which makes it&#8217;s absolutely legitimate for users to want a different arbitrary value, if you will.</p>
</div>
<div class="paragraph">
<p>Again, low priority and low implementation effort (for someone with experience with Sonar code), but still valuable from my perspective.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_171347_ann_campbell_wrote">on 4 Mar 2016, 17:13:47 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I think there&#8217;s a misunderstanding here [~tna]: These are rule specification tickets, not tickets for work to be done on the SonarQube platform. It sounds like you&#8217;re simply after the already-available "Remember me on this computer" feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_aug_2016_234955_tomislav_nakic_alfirevic_wrote">on 15 Aug 2016, 23:49:55 Tomislav Nakic-Alfirevic wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m not sure. "Remember me" is what&#8217;s typically used to log back in easily when your session times out. What I&#8217;m talking about is being able to set the session to a very large period of time, so that logging back in isn&#8217;t needed in the first place.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_aug_2016_133825_ann_campbell_wrote">on 16 Aug 2016, 13:38:25 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tna] you need to open a thread for this on the <a href="https://groups.google.com/forum/?pli=1#!forum/sonarqube">Google group</a>.</p>
</div>
</div>
</div>
</div>