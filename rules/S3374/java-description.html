<div class="paragraph">
<p>According to the Common Weakness Enumeration,</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>If two validation forms have the same name, the Struts Validator arbitrarily chooses one of the forms to use for input validation and discards the other. This decision might not correspond to the programmer&#8217;s expectations&#8230;&#8203;</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>In such a case, it is likely that the two forms should be combined. At the very least, one should be removed.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;  &lt;!-- Noncompliant --&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/102.html">MITRE, CWE-102</a> - Struts: Duplicate Validation Forms</p>
</li>
<li>
<p><a href="https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation">OWASP, Improper Data Validation</a> - Struts: Duplicate Validation Forms</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Rename this form; line x holds another form declaration with the same name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>primary: second instance of form name</p>
</li>
<li>
<p>secondary: original instance of form name</p>
<div class="ulist">
<ul>
<li>
<p>message: original</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2015_144934_ann_campbell_wrote">on 12 Oct 2015, 14:49:34 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>in <code>validation.xml</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2018_110446_sébastien_gioria_appsecfr_wrote">on 19 Mar 2018, 11:04:46 Sébastien GIORIA - AppSecFR wrote:</h3>
<div class="paragraph">
<p>According to [CWE-102], is a member of A1:2017 Injection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2018_170701_alexandre_gigleux_wrote">on 29 May 2018, 17:07:01 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~SPoint] CWE-102 is saying "OWASP Top Ten 2004 Category A1 - Unvalidated Input" and there is no longer a category for "Unvalidated Input".</p>
</div>
</div>
</div>
</div>