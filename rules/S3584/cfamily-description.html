<div class="paragraph">
<p>Memory allocated dynamically with <code>calloc(...)</code>, <code>malloc(...)</code>, <code>realloc(...)</code> or <code>new</code> should be released when it&#8217;s not needed anymore. Failure to do so will result in a memory leak that could bring the box to its knees.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when memory is allocated and not freed in the same function. Allocated memory is ignored if a pointer to it is <code>return</code>ed to the caller or stored in a structure that&#8217;s external to the function.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>int fun() {
  char* name = (char *) malloc (size);
  if (!name) {
    return 1;
  }
  // ...
  return 0; // Noncompliant, memory pointed by "name" has not been released
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>int fun() {
  char* name = (char *) malloc (size);
  if (!name) {
    return 1;
  }
  // ...
  free(name);
  return 0;
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/401.html">MITRE, CWE-401</a> - Improper Release of Memory Before Removing Last Reference ('Memory Leak')</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/FtYxBQ">MEM00-C.</a> - Allocate and free memory in the same module, at the same level of abstraction</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/GNYxBQ">CERT, MEM31-C.</a> - Free dynamically allocated memory when no longer needed</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Review the data-flow; this memory allocation might not have been released when reaching exit point at line <code>line</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary: the allocation call - [m|c|re]alloc|new</p>
</li>
<li>
<p>Additional: statement exiting the function</p>
<div class="ulist">
<ul>
<li>
<p>Message: Exit point</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_30_mar_2016_170339_ann_campbell_wrote">on 30 Mar 2016, 17:03:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~massimo.paladin] I&#8217;ve expanded the description, and added an "issue raised when" section. It describes what seems like a reasonable scope for the rule, but may not match the scope you had in mind.</p>
</div>
<div class="paragraph">
<p>Also, I&#8217;ve greatly expanded the references section based on the standards' titles.</p>
</div>
</div>
</div>
</div>