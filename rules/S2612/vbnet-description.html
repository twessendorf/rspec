<div class="paragraph">
<p>In Unix, "others" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
</div>
<div class="paragraph">
<p>In Windows, "Everyone" group is similar and includes all members of the Authenticated Users group as well as the built-in Guest account, and several other built-in security accounts.</p>
</div>
<div class="paragraph">
<p>Granting permissions to these groups can lead to unintended access to files.</p>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The application is designed to be run on a multi-user environment.</p>
</li>
<li>
<p>Corresponding files and directories may contain confidential information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>.Net Framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim unsafeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Allow)

Dim fileSecurity = File.GetAccessControl("path")
fileSecurity.AddAccessRule(unsafeAccessRule) ' Sensitive
fileSecurity.SetAccessRule(unsafeAccessRule) ' Sensitive
File.SetAccessControl("fileName", fileSecurity)</pre>
</div>
</div>
<div class="paragraph">
<p>.Net / .Net Core</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim fileInfo = new FileInfo("path")
Dim fileSecurity = fileInfo.GetAccessControl()

fileSecurity.AddAccessRule(new FileSystemAccessRule("Everyone", FileSystemRights.Write, AccessControlType.Allow)) ' Sensitive
fileInfo.SetAccessControl(fileSecurity)</pre>
</div>
</div>
<div class="paragraph">
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim fileSystemEntry = UnixFileSystemInfo.GetFileSystemEntry("path")
fileSystemEntry.FileAccessPermissions = FileAccessPermissions.OtherReadWriteExecute ' Sensitive</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>.Net Framework</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny)

Dim fileSecurity = File.GetAccessControl("path")
fileSecurity.AddAccessRule(safeAccessRule)
File.SetAccessControl("path", fileSecurity)</pre>
</div>
</div>
<div class="paragraph">
<p>.Net / .Net Core</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny)

Dim fileInfo = new FileInfo("path")
Dim fileSecurity = fileInfo.GetAccessControl()
fileSecurity.SetAccessRule(safeAccessRule)
fileInfo.SetAccessControl(fileSecurity)</pre>
</div>
</div>
<div class="paragraph">
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Dim fs = UnixFileSystemInfo.GetFileSystemEntry("path")
fs.FileAccessPermissions = FileAccessPermissions.UserExecute</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A4</a> - Insecure Design</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Test_File_Permission_(OTG-CONFIG-009)">OWASP File Permission</a></p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/732.html">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/266.html">MITRE, CWE-266</a> -  Incorrect Privilege Assignment</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this permission is safe.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_sep_2020_204444_ann_campbell_wrote">on 23 Sep 2020, 20:44:44 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>It&#8217;s funny to see my face as the reporter of this when the content are entirely new to me. :)</p>
</div>
<div class="paragraph">
<p>\[~eric.therond] not to be a PITA, but if <code>others</code> has access, then all access <em>is</em> authorized, and there can be no "unauthorized" access, right? Perhaps you meant "unintended"? Also, IMO this description could benefit from being fluffed up a little with a tiny bit reminder of how file permissions are granted to owner, group, others</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_sep_2020_085308_eric_therond_wrote">on 24 Sep 2020, 08:53:08 Eric Therond wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] You can put me as the reporter, I think I don&#8217;t have the permission or I didn&#8217;t find how to change it.</p>
</div>
<div class="paragraph">
<p>Indeed, "unintended" is more appropriate.</p>
</div>
<div class="paragraph">
<p>I prefer to have a short rule description rather than explaining how file permissions work, and the code examples in the different sub-tasks or the links in the "see section" can help the user figure this out.</p>
</div>
</div>
</div>
</div>