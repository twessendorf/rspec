<div class="paragraph">
<p>Disposing an object twice, either with the <code>using</code> keyword or by calling <code>Dispose</code> directly, in the same method is at best confusing and at worst error-prone. The next developer might see only one of the <code>Dispose</code>/<code>using</code> and try to use an already-disposed object.</p>
</div>
<div class="paragraph">
<p>In addition, even if <a href="https://docs.microsoft.com/en-us/dotnet/api/system.idisposable.dispose?view=netcore-3.1">the documentation of <code>Disposable</code></a> explicitly states that calling the <code>Dispose</code> method multiple times should not throw an exception, some implementation still do it. Thus it is safer to not dispose an object twice when possible.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when, in the same method, the <code>Dispose</code> method is explicitly called twice on the same object, or when <code>using</code> is used with a direct call to <code>Dispose()</code>.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>using (var d = new Disposable()) // Noncompliant
{
    d.Dispose();
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>using var d = new Disposable();
d.Dispose(); // Noncompliant {{Refactor this code to make sure 'd' is disposed only once.}}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>using var d = new Disposable();</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Refactor this code to make sure Dispose is only called once with this object.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary: Second dispose or using</p>
</div>
<div class="paragraph">
<p>Secondary: Previous dispose or using</p>
</div>
</div>
</div>
</div>