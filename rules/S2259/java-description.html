<div class="paragraph">
<p>A reference to <code>null</code> should never be dereferenced/accessed. Doing so will cause a <code>NullPointerException</code> to be thrown. At best, such an exception will cause abrupt program termination. At worst, it could expose debugging information that would be useful to an attacker, or it could allow an attacker to bypass security measures.</p>
</div>
<div class="paragraph">
<p>Note that when they are present, this rule takes advantage of <code>@CheckForNull</code> and <code>@Nonnull</code> annotations defined in <a href="https://jcp.org/en/jsr/detail?id=305">JSR-305</a> to understand which values are and are not nullable except when <code>@Nonnull</code> is used on the parameter to <code>equals</code>, which by contract should always work with null.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>@CheckForNull
String getName(){...}

public boolean isNameEmpty() {
  return getName().length() == 0; // Noncompliant; the result of getName() could be null, but isn't null-checked
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Connection conn = null;
Statement stmt = null;
try{
  conn = DriverManager.getConnection(DB_URL,USER,PASS);
  stmt = conn.createStatement();
  // ...

}catch(Exception e){
  e.printStackTrace();
}finally{
  stmt.close();   // Noncompliant; stmt could be null if an exception was thrown in the try{} block
  conn.close();  // Noncompliant; conn could be null if an exception was thrown
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>private void merge(@Nonnull Color firstColor, @Nonnull Color secondColor){...}

public  void append(@CheckForNull Color color) {
    merge(currentColor, color);  // Noncompliant; color should be null-checked because merge(...) doesn't accept nullable parameters
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>void paint(Color color) {
  if(color == null) {
    System.out.println("Unable to apply color " + color.toString());  // Noncompliant; NullPointerException will be thrown
    return;
  }
  ...
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/476.html">MITRE, CWE-476</a> - NULL Pointer Dereference</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/QdcxBQ">CERT, EXP34-C.</a> - Do not dereference null pointers</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/aDdGBQ">CERT, EXP01-J.</a> - Do not use a null in a case where an object is required</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>'XXXX' is nullable here and method 'YYY' don&#8217;t accept nullable argument</p>
</li>
<li>
<p>NullPointerException might be thrown as 'XXXX' is nullable here</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary : the variable on which a function call can lead to a null pointer dereference (if this value is the output of another function call, this other function call must be highlighted instead)</p>
</div>
<div class="paragraph">
<p>Secondary : the last locations in the code where the nullability condition has been set on the variable. The associated location message should be either :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>So "xxxx" is null</p>
</li>
<li>
<p>So "xxxx" is nullable</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_mar_2015_131546_freddy_mallet_wrote">on 23 Mar 2015, 13:15:46 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann, could you review this sub-task ? Thanks</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_mar_2015_124738_samuel_mercier_wrote">on 24 Mar 2015, 12:47:38 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>first example is wrong, since <code>instanceof</code> would return <code>false</code> if <code>obj</code> is <code>null</code>.</p>
</div>
<div class="paragraph">
<p>Interestingly, from null/notnull point of view, <code>a instanceof b</code> is equivalent to <code>a != null</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_mar_2015_134555_samuel_mercier_wrote">on 24 Mar 2015, 13:45:55 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I updated the first non compliant code snippet.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_mar_2015_150213_samuel_mercier_wrote">on 24 Mar 2015, 15:02:13 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>Removed message * NullPointerException will be thrown as 'XXXX' is for sure null here, since we are currently unable to make distinction between @Nullable and if (&#8230;&#8203; == null)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_sep_2019_051431_qxo_wrote">on 19 Sep 2019, 05:14:31 QXO wrote:</h3>
<div class="paragraph">
<p>This code shouldnot should not be a issue ( in <code>url.substring(0,start)</code> url never not null)</p>
</div>
<div class="paragraph">
<p>It&#8217;s sonarqube(7.9.1) check implements issue, please fix the issue:)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public String testSonarNullCheckIssue(final String url,final boolean isUrl) {
   int start = url != null &amp;&amp; isUrl ? url.indexOf('?') : -1;
   if(start != -1 ){
       return url.substring(0,start);
   }
   return url;
} {code}

ref: https://drive.google.com/open?id=1MuZMBm8bkwz_Q5mZIwEaDsJoh-qaopW_</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_sep_2019_072431_alexandre_gigleux_wrote">on 19 Sep 2019, 07:24:31 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>Thanks for the feedback [~qxo]!</p>
</div>
<div class="paragraph">
<p>Can you report the FP in the community forum https://community.sonarsource.com/tags/c/bug/fp/java so it gets more visibility and be addressed?</p>
</div>
<div class="paragraph">
<p>JIRA comments are not convenient to manage FPs.</p>
</div>
<div class="paragraph">
<p>Thanks</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1678">is duplicated by: S1678</h3>

</div>
<div class="sect2">
<h3 id="_replaces_s2220">replaces: S2220</h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s1697">supercedes: S1697</h3>

</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_123815_sébastien_gioria_wrote">on 11 Feb 2015, 12:38:15 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This Rule fall into :</p>
</div>
<div class="paragraph">
<p>OWASP A6 &#8658; if this expose informations</p>
</div>
<div class="paragraph">
<p>OWASP A2 &#8658; if this can give attackers capacity to bypass authentication or authorization</p>
</div>
<div class="paragraph">
<p>OWASP A1 &#8658; is this can give attacker capacity to inject something</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_131839_ann_campbell_wrote">on 11 Feb 2015, 13:18:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
</div>
</div>