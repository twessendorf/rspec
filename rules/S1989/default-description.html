<div class="paragraph">
<p>Even though the signatures for methods in a servlet include <code>throws IOException, ServletException</code>, it&#8217;s a bad idea to let such exceptions be thrown. Failure to catch exceptions in a servlet could leave a system in a vulnerable state, possibly resulting in denial-of-service attacks, or the exposure of sensitive information because when a servlet throws an exception, the servlet container typically sends debugging information back to the user. And that information could be very valuable to an attacker.</p>
</div>
<div class="paragraph">
<p>This rule checks all exceptions in methods named "do*" are explicitly handled in servlet classes.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>public void doGet(HttpServletRequest request, HttpServletResponse response)
  throws IOException, ServletException {
  String ip = request.getRemoteAddr();
  InetAddress addr = InetAddress.getByName(ip); // Noncompliant; getByName(String) throws UnknownHostException
  //...
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>public void doGet(HttpServletRequest request, HttpServletResponse response)
  throws IOException, ServletException {
  try {
    String ip = request.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    //...
  }
  catch (UnknownHostException uhex) {
    //...
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/600.html">MITRE, CWE-600</a> - Uncaught Exception in Servlet</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/-zZGBQ">CERT, ERR01-J.</a> - Do not allow exceptions to expose sensitive information</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Handle the following exception(s) that could be thrown by "xxx": ExceptionType.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_19_sep_2014_133526_freddy_mallet_wrote">on 19 Sep 2014, 13:35:26 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I would activate this rule by default because I don&#8217;t see when this rule might generate some false-positives</p>
</li>
<li>
<p>I would associate the rule to the SQALE sub-characteristic "Error"</p>
</li>
<li>
<p>I guess this rule belongs to OWASP Top 10 ?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_sep_2014_114456_ann_campbell_wrote">on 22 Sep 2014, 11:44:56 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>For the record: not in the OWASP Top 10</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_212602_sébastien_gioria_wrote">on 12 Dec 2014, 21:26:02 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>as the result could be to stackTrace or information reply on the browser, we could consider this issue in OWASP-TOP10-A6</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_dec_2014_102203_freddy_mallet_wrote">on 15 Dec 2014, 10:22:03 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>This is a good point [~sebastien.gioria] which raises another question: for the time being we tag a rule relating to a CWE item with tag "owasp-top10" if and only if in the MITRE CWE referential, this CWE item is part of <a href="http://cwe.mitre.org/data/definitions/928.html">CWE-928: Weaknesses in OWASP Top Ten (2013)</a>. Do you think this is a too strong requirement [~sebastien.gioria] ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_jul_2015_074937_ann_campbell_wrote">on 20 Jul 2015, 07:49:37 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Tagged java-top by Ann</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_nov_2019_150656_guillaume_dequenne_wrote">on 13 Nov 2019, 15:06:56 Guillaume Dequenne wrote:</h3>
<div class="paragraph">
<p>Updating the message to explicitly mention which unhandled exception type triggered the issue (as the method invocation could already be in a try/catch block without a correct catch clause).</p>
</div>
</div>
</div>
</div>