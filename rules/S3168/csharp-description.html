<div class="paragraph">
<p>An <code>async</code> method with a <code>void</code> return type is a "fire and forget" method best reserved for event handlers because there&#8217;s no way to wait for the method&#8217;s execution to complete and respond accordingly. There&#8217;s also no way to <code>catch</code> exceptions thrown from the method.</p>
</div>
<div class="paragraph">
<p>Having an <code>async void</code> method that is not an event handler could mean your program works some times and not others because of timing issues. Instead, <code>async</code> methods should return <code>Task</code>.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when non-event handler methods are both <code>async</code> and <code>void</code>.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>class HttpPrinter
{
  private string content;

  public async void CallNetwork(string url) //Noncompliant
  {
    var client = new HttpClient();
    var response = await client.GetAsync(url);
    content = await response.Content.ReadAsStringAsync();
  }

  public async Task PrintContent(string url)  // works correctly if web request finishes in under 1 second, otherwise content will be null
  {
    CallNetwork(url);
    await Task.Delay(1000);
    Console.Write(content);
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>class HttpPrinter
{
  private string content;

  public async Task CallNetwork(string url)
  {
    var client = new HttpClient();
    var response = await client.GetAsync(url);
    content = await response.Content.ReadAsStringAsync();
  }

  public async Task PrintContent(string url)
  {
    await CallNetwork(url); // &lt;----- call changed here. If await is not added warning CS4014 will be triggered
    await Task.Delay(1000);
    Console.Write(content);
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Event handlers, i.e. methods with two arguments, first one matching type <code>object</code> or name <code>sender</code> and the second being or inheriting from <code>EventArgs</code>, are ignored.</p>
</div>
<div class="paragraph">
<p>Methods named as <code>OnSomething</code> are also ignored.</p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Return "Task" instead.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_30_jun_2015_133613_ann_campbell_wrote">on 30 Jun 2015, 13:36:13 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] I don&#8217;t understand the code snippets. The <code>async Task</code> method doesn&#8217;t return anything.</p>
</div>
<div class="paragraph">
<p>Also, could you morph the Noncompliant Example into a Compliant Solution, please?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_jul_2015_071048_tamas_vajk_wrote">on 1 Jul 2015, 07:10:48 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I added the compliant solution.</p>
</div>
<div class="paragraph">
<p>A method with <code>async</code> keyword returning a <code>Task</code> is like a non <code>async</code> method with <code>void</code> return type. Similarly in an <code>async Task&lt;int&gt;</code> method we can return a simple <code>int</code>. (https://msdn.microsoft.com/en-us/library/hh524395.aspx)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_jul_2015_113153_ann_campbell_wrote">on 1 Jul 2015, 11:31:53 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] that makes me wonder if we should generalize this rule to catch <em>any</em> <code>async</code> method that does not return a <code>Task</code>&#8230;&#8203;?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_jul_2015_114954_tamas_vajk_wrote">on 1 Jul 2015, 11:49:54 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] That&#8217;s a compiler error (CS1983, <em>The return type of async must be void, Task or Task&lt;T&gt;</em>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_jul_2015_115939_ann_campbell_wrote">on 1 Jul 2015, 11:59:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Okay, thanks [~tamas.vajk]</p>
</div>
</div>
</div>
</div>