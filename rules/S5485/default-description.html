<div class="paragraph">
<p>The standard C library includes a number of functions for handling streams. If not called correctly, these functions can have undefined behavior. More specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FILE*</code> should be checked for null before being used in a function that accesses the file content</p>
</li>
<li>
<p>The third argument of <code>fseek</code> must be <code>SEEK_SET</code>, <code>SEEK_END</code>, or <code>SEEK_CUR</code></p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>FILE *file1 = fopen("myFile", "r");
fseek(file1, 1, SEEK_SET); // Noncompliant, file could be NULL
fclose(file1);

FILE *file2 = tmpfile();
ftell(file2); // Noncompliant, file could be NULL
if (file2) {
  fseek(file2, 1, 3); // Noncompliant, third argument should either be SEEK_SET, SEEK_CUR or SEEK_END
}
fclose(file2);</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>FILE *file1 = fopen("myFile", "r");
if (file1) {
  fseek(file1, 1, SEEK_SET);
  fclose(file1);
}

FILE *file2 = tmpfile();
if (file2) {
  ftell(file2);
  fseek(file2, 1, SEEK_END);
  fclose(file2);
}</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s2095">is related to: S2095</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s3588">is related to: S3588</h3>

</div>
<div class="sect2">
<h3 id="_on_22_oct_2019_162015_loïc_joly_wrote">on 22 Oct 2019, 16:20:15 Loïc Joly wrote:</h3>
<div class="paragraph">
<p>\[~amelie.renard] I heavily reworded this one, can you validate please?</p>
</div>
</div>
</div>
</div>