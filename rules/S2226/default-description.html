<div class="paragraph">
<p>By contract, a servlet container creates one instance of each servlet and then a dedicated thread is attached to each new incoming HTTP request to process the request. So all threads share the servlet instances and by extension their instance fields.  To prevent any misunderstanding and unexpected behavior at runtime, all servlet fields should then be either <code>static</code> and/or <code>final</code>, or simply removed.</p>
</div>
<div class="paragraph">
<p>With Struts 1.X, the same constraint exists on <code>org.apache.struts.action.Action</code>.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>public class MyServlet extends HttpServlet {
  private String userName;  //As this field is shared by all users, it's obvious that this piece of information should be managed differently
  ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class MyAction extends Action {
  private String userName;  //Same reason
  ...
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Fields annotated with <code>@javax.inject.Inject</code>, <code>@javax.ejb.EJB</code>, <code>@org.springframework.beans.factory.annotation.Autowired</code>, <code>@javax.annotation.Resource</code></p>
</li>
<li>
<p>Fields initialized in <code>init()</code> or <code>init(ServletConfig config)</code> methods</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/2TZGBQ">CERT, MSC11-J.</a> - Do not let session information leak within a servlet</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this misleading mutable servlet instance fields or make it "static" and/or "final"</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s2223">is related to: S2223</h3>

</div>
<div class="sect2">
<h3 id="_on_25_nov_2014_110013_freddy_mallet_wrote">on 25 Nov 2014, 11:00:13 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] If you want I can take care to fully rewrite the rule in something like "Servlet should not have misleading non-static fields"</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_25_nov_2014_122816_ann_campbell_wrote">on 25 Nov 2014, 12:28:16 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] the original requester was specific that the rule shouldn&#8217;t be limited to just <code>Servlet</code> classes, but I&#8217;m happy to go along if you feel that would make a better rule.</p>
</div>
<div class="paragraph">
<p>BTW, he&#8217;s also asking for an ignoreClasses parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_mar_2019_232730_victor_matskiv_wrote">on 7 Mar 2019, 23:27:30 Victor Matskiv wrote:</h3>
<div class="paragraph">
<p>The issue is not aligned with servlet semantics. Specifically:</p>
</div>
<div class="paragraph">
<p>A servlet can be legitimately initialized from ServletContext usingÂ <code>init(ServletContext)</code> method. This makes it impossible to qualify servlet fields as final.</p>
</div>
<div class="paragraph">
<p>Another suggestion to make servlet fields static introduces rather misleading semantics and contradicts the referenced document: https://wiki.sei.cmu.edu/confluence/display/java/MSC11-J.+Do+not+let+session+information+leak+within+a+servlet</p>
</div>
</div>
</div>
</div>