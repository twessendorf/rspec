<div class="paragraph">
<p>Binding a temporary object to a reference to const usually lengthens the lifetime of the temporary: instead of being destroyed at the end of the full expression, the temporary will have the same lifetime as the reference itself.</p>
</div>
<div class="paragraph">
<p>However, lifetime extension is not transitive, so if the definition of the temporary relies on another temporary, this second temporary will always be destroyed at the end of the full expression, creating an immediately dangling reference.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>#include &lt;vector&gt;
#include &lt;optional&gt;

using namespace std;

void f(int i);

int main() {
    // the vector is a temporary object, and binding a reference to its first element will not extend the vector lifetime
    auto const &amp;val = vector{1, 2, 3}[0]; // Noncompliant, val is an immediately dangling reference
    f(val);

    int &amp;&amp; rval = *std::optional&lt;int&gt;();  // Noncompliant, rval is an immediately dangling reference
}</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_13_dec_2019_185941_loïc_joly_wrote">on 13 Dec 2019, 18:59:41 Loïc Joly wrote:</h3>
<div class="paragraph">
<p>\[~amelie.renard]: From the example, you seem to want to report at the place the immediately dangling reference is used, not at the place it is created. I think this is significantly more complex, for little added value (anyways, the place to correct is probably the creation place). I changed it. One consequence is the possibility of "true" false positives, if the reference is created, but never used. But this is probably an uncommon pattern, and at least a pitfall.</p>
</div>
<div class="paragraph">
<p>I also changed some wording, can you review?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_dec_2019_093146_amélie_renard_wrote">on 16 Dec 2019, 09:31:46 Amélie Renard wrote:</h3>
<div class="paragraph">
<p>\[~loic.joly] Seems good to me, thanks.</p>
</div>
</div>
</div>
</div>