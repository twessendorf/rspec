<div class="paragraph">
<p>Nested <code>IF...ELSE</code>, <code>WHILE</code> and <code>TRY...CATCH</code> statements is a key ingredient for making what&#8217;s known as "Spaghetti code".</p>
</div>
<div class="paragraph">
<p>Such code is hard to read, refactor and therefore maintain.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the default threshold of 4:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>IF @flag1 = 1 -- Compliant - depth = 1
  BEGIN
    IF @flag2 = 2 -- Compliant - depth = 2
      BEGIN
        WHILE @var1 &gt; 0  -- Compliant - depth = 3
          BEGIN
            IF @flag3 = 3 -- Compliant - depth = 4, not exceeding the limit
              BEGIN
                IF @flag4 = 4 -- Noncompliant - depth = 5
                  BEGIN
                    IF @flag5 = 5 -- Depth = 6, exceeding the limit, but issues are only reported on depth = 5
                      BREAK
                  END
              END
            SET @var1 = @var1 - 1
          END
      END
  END</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Refactor this code to not nest more than {} ["if", "for", "while", "switch" and "try"|"IF", "CASE", "DO", "LOOP", "SELECT", "WHILE" and "PROVIDE"|control flow] statements.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="ulist">
<ul>
<li>
<p>key = max
Description: Maximum allowed control flow statement nesting depth.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Default Value: 4</p>
</div>
<div class="paragraph">
<p>Type: Integer</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary: The most deeply nested control flow statement</p>
</li>
<li>
<p>Secondary: Every parent control flow statement.
message: 'Nesting +1.'</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_7_mar_2018_185840_ann_campbell_wrote">on 7 Mar 2018, 18:58:40 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] we haven&#8217;t (yet) deprecated this rule in favor of Cognitive Complexity, but do we want to continue adding new implementations?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_mar_2018_083640_freddy_mallet_wrote">on 8 Mar 2018, 08:36:40 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>I would say yes [~ann.campbell.2] because for me the best way to get a massive adoption of the Cognitive Complexity metric is by not forcing anyone to use it. This rule is a good example of a basic feature that any developer not knowing the cognitive complexity metric would expect from a rule engine. And I think that would be a mistake to generate a kind of friction at the adoption of the rule engine by forcing people to "buy" the Cognitive Complexity metric. But promoting the Cognitive Complexity rule/metric in the description of this rule can be a good idea.</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_related_to_s3358">is related to: S3358</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s1684">is related to: S1684</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s1821">is related to: S1821</h3>

</div>
<div class="sect2">
<h3 id="_on_6_aug_2013_121122_freddy_mallet_wrote">on 6 Aug 2013, 12:11:22 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Is implemented by http://jira.codehaus.org/browse/SONARJAVA-267</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_aug_2013_081658_dinesh_bolkensteyn_wrote">on 14 Aug 2013, 08:16:58 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>I think that 'Non-Compliant' should really be reserved to illustrate that the rule <strong>WILL</strong> produce an issue on that line.</p>
</div>
<div class="paragraph">
<p>It should not be used for exceptions - else the meaning of Compliant / Non-Compliant becomes hard to understand.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_31_oct_2013_161406_freddy_mallet_wrote">on 31 Oct 2013, 16:14:06 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Is implemented by http://jira.codehaus.org/browse/SONARPLUGINS-3229 for Flex</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2013_164218_freddy_mallet_wrote">on 12 Dec 2013, 16:42:18 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Flex and C&#43;&#43; implementations should be updated to take into account "try" statement</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_feb_2014_220752_freddy_mallet_wrote">on 12 Feb 2014, 22:07:52 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Is implemented by http://jira.codehaus.org/browse/SONARPLUGINS-3472 for PHP</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_feb_2018_105027_tibor_blenessy_wrote">on 7 Feb 2018, 10:50:27 Tibor Blenessy wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] [~alban.auzeill] shouldn&#8217;t this rule be deprecated in favor of Cognitive Complexity RSPEC-3776?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_feb_2018_163301_alban_auzeill_wrote">on 7 Feb 2018, 16:33:01 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>This rule addresses a specific need. A lot of linters provide this feature, so for users not yet ready to embrace cognitive complexity, we also would like to provide it. For more details, ask [~freddy.mallet]</p>
</div>
</div>
</div>
</div>