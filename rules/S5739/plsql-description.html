<div class="paragraph">
<p>When implementing the HTTPS protocol, the website mostly continue to support the HTTP protocol to redirect users to HTTPS when they request a HTTP version of the website. These redirects are not encrypted and are therefore vulnerable to man in the middle attacks. The <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security policy header</a> (HSTS) set by an application instructs the web browser to convert any HTTP request to HTTPS.</p>
</div>
<div class="paragraph">
<p>Web browsers that see the Strict-Transport-Security policy header for the first time record information specified in the header:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>max-age</code> directive which specify how long the policy should be kept on the web browser.</p>
</li>
<li>
<p>the <code>includeSubDomains</code> optional directive which specify if the policy should apply on all sub-domains or not.</p>
</li>
<li>
<p>the <code>preload</code> optional directive which is not part of the HSTS specification but supported on all modern web browsers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the <code>preload</code> directive the web browser never connects in HTTP to the website and to use this directive, it is required <a href="https://hstspreload.org/">to submit</a> the concerned application to a preload service maintained by Google.</p>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The website is accessible with the unencrypted HTTP protocol.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to this question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implement Strict-Transport-Security policy header, it is recommended to apply this policy to all subdomains (<code>includeSubDomains</code>) and for at least 6 months (<code>max-age=15552000</code>) or even better for 1 year (<code>max-age=31536000</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">developer.mozilla.org</a> - Strict Transport Security</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure disabling Strict-Transport-Security policy is safe here.</p>
</div>
</div>
</div>
</div>