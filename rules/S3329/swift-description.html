<div class="paragraph">
<p>When encrypting data with the Cipher Block Chaining (CBC) mode an Initialization Vector (IV) is used to randomize the encryption, ie under a given key the same plaintext doesn&#8217;t always produce the same ciphertext. The IV doesn&#8217;t need to be secret but should be unpredictable to avoid  "Chosen-Plaintext Attack".</p>
</div>
<div class="paragraph">
<p>To generate Initialization Vectors, NIST recommends to use a secure random number generator.</p>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec Verification Standard</a> - Cryptography Requirements</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> - Insufficient Cryptography</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/329.html">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/330.html">MITRE, CWE-330</a> - Use of Insufficiently Random Values</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/340.html">MITRE, CWE-340</a> - Generation of Predictable Numbers or Identifiers</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/1204.html">MITRE, CWE-1204</a> - Generation of Weak Initialization Vector (IV)</p>
</li>
<li>
<p><a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block  Cipher Modes of Operation</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a dynamically-generated, random IV.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_duplicates_s3275">duplicates: S3275</h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s4787">relates to: S4787</h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s2245">is related to: S2245</h3>

</div>
<div class="sect2">
<h3 id="_on_22_oct_2020_095327_alexandre_gigleux_wrote">on 22 Oct 2020, 09:53:27 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~pierre-loup.tristant] For C#, we could use the 17 test cases produced by the SARD (https://samate.nist.gov/SARD/testsuite.php &gt; Juliet Test Suite for C#). It&#8217;s inside the directory CWE329_Not_Using_Random_IV_with_CBC_Mode.</p>
</div>
</div>
</div>
</div>