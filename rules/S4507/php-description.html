<div class="paragraph">
<p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a></p>
</li>
<li>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a></p>
</li>
<li>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application&#8217;s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to detailed information on both the system running the application and users.</p>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>the code or configuration enabling the application debug features is deployed on production servers or distributed to end users.</p>
</li>
<li>
<p>the application runs by default with debug features activated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CakePHP 1.x, 2.x:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Configure::write('debug', 1); // Sensitive: development mode
or
Configure::write('debug', 2); // Sensitive: development mode
or
Configure::write('debug', 3); // Sensitive: development mode</pre>
</div>
</div>
<div class="paragraph">
<p>CakePHP 3.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>use Cake\Core\Configure;

Configure::config('debug', true); // Sensitive: development mode</pre>
</div>
</div>
<div class="paragraph">
<p>WordPress:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>define( 'WP_DEBUG', true ); // Sensitive: development mode</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CakePHP 1.2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Configure::write('debug', 0); // Compliant; this is the production mode</pre>
</div>
</div>
<div class="paragraph">
<p>CakePHP 3.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>use Cake\Core\Configure;

Configure::config('debug', false); // Compliant:  "0" or "false" for CakePHP 3.x is suitable (production mode) to not leak sensitive data on the logs.</pre>
</div>
</div>
<div class="paragraph">
<p>WordPress:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>define( 'WP_DEBUG', false ); // Compliant</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/489.html">MITRE, CWE-489</a> - Active Debug Code</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/215.html">MITRE, CWE-215</a> - Information Exposure Through Debug Information</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this debug feature is deactivated before delivering the code in production.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s3563">deprecates: S3563</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1148">deprecates: S1148</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1442">deprecates: S1442</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1525">deprecates: S1525</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1628">deprecates: S1628</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1685">deprecates: S1685</h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1951">deprecates: S1951</h3>

</div>
<div class="sect2">
<h3 id="_on_19_apr_2018_111633_alexandre_gigleux_wrote">on 19 Apr 2018, 11:16:33 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>This is a "Security Hotspot".</p>
</div>
</div>
</div>
</div>