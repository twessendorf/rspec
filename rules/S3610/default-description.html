<div class="paragraph">
<p>Calling <code>GetType()</code> on a nullable object returns the underlying value type. Thus, comparing the returned <code>Type</code> object to <code>typeof(Nullable&lt;SomeType&gt;)</code> doesn&#8217;t make sense. The comparison either throws an exception or the result can be known at compile time.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>int? nullable = 42;
bool comparison = nullable.GetType() == typeof(Nullable&lt;int&gt;); // Noncompliant, always false
comparison = nullable.GetType() != typeof(Nullable&lt;int&gt;); // Noncompliant, always true

nullable = null;
comparison = nullable.GetType() != typeof(Nullable&lt;int&gt;); // Noncompliant, calling GetType on a null always throws an exception</pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this redundant type comparison.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>full expression</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s2219">relates to: S2219</h3>

</div>
<div class="sect2">
<h3 id="_on_25_apr_2016_102459_tamas_vajk_wrote">on 25 Apr 2016, 10:24:59 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2], could you review this RSPEC? Thanks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_apr_2016_174016_ann_campbell_wrote">on 26 Apr 2016, 17:40:16 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] this rule is a subset of what would be covered by an implementation of RSPEC-2583. When reading it my first thought was that you wrote it stand-alone to cover a R# rule, but there are no references&#8230;&#8203;?</p>
</div>
<div class="paragraph">
<p>Also, if we retain this RSpec, IMO you should add a compliant solution. From the description and code sample, I&#8217;m <em>guessing</em> compliance is a straightforward code change&#8230;&#8203;?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_apr_2016_084157_tamas_vajk_wrote">on 27 Apr 2016, 08:41:57 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] yes, it&#8217;s a special case of RSPEC-2583.</p>
</div>
<div class="paragraph">
<p>No, it&#8217;s not a R# rule. It&#8217;s the outcome of a bug in one of our rules (RSPEC-2219, added an exception there).</p>
</div>
<div class="paragraph">
<p>The compliant solution is not straightforward. We can&#8217;t simply replace the comparison with <code>true</code> or <code>false</code> because that was definitely not what was meant. We could change the <code>typeof(Nullable&lt;int&gt;)</code> to <code>typeof(int)</code>, but I don&#8217;t think that covers the user intent. Most probably the user wanted to check if <code>nullable</code> is a <code>Nullable&lt;T&gt;</code> or not, but that&#8217;s not possible with <code>GetType</code>. And there&#8217;s no straightforward way to do it, unless you have the type of <code>nullable</code> at compile time.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_apr_2016_174422_ann_campbell_wrote">on 27 Apr 2016, 17:44:22 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] I had assumed you&#8217;d want to use <code>is</code> (or something similar) instead. Glad I didn&#8217;t fill in a compliant solution! :-)</p>
</div>
<div class="paragraph">
<p>For me, the description moves very quickly from</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Calling GetType() on a nullable object returns the underlying value type.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Thus, comparing the returned Type object to typeof(Nullable&lt;SomeType&gt;) doesn&#8217;t make sense.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>But if C#ers will understand, I&#8217;m good with it.</p>
</div>
</div>
</div>
</div>