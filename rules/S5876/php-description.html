<div class="paragraph">
<p>Session fixation attacks occur when an attacker can force a legitimate user to use a session ID that he knows. To avoid fixation attacks, it&#8217;s a good practice to generate a new session each time a user authenticates and delete/invalidate the existing session (the one possibly known by the attacker).</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a <a href="https://symfony.com/doc/current/reference/configuration/security.html#session-fixation-strategy">Symfony Security</a>'s context, session fixation protection can be disabled with the value <code>none</code> for the <code>session_fixation_strategy</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>namespace Symfony\Component\DependencyInjection\Loader\Configurator;

return static function (ContainerConfigurator $container) {
    $container-&gt;extension('security', [
        'session_fixation_strategy' =&gt; 'none', // Noncompliant
    ]);
};</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a <a href="https://symfony.com/doc/current/reference/configuration/security.html#session-fixation-strategy">Symfony Security</a>'s context, session fixation protection is enabled by default. It can be explicitly enabled with the values <code>migrate</code> and <code>invalidate</code> for the <code>session_fixation_strategy</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>namespace Symfony\Component\DependencyInjection\Loader\Configurator;

return static function (ContainerConfigurator $container) {
    $container-&gt;extension('security', [
        'session_fixation_strategy' =&gt; 'migrate', // Compliant
    ]);
};</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and Authentication Failures</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Session_fixation">OWASP Sesssion Fixation</a></p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/384.html">MITRE, CWE-384</a> - Session Fixation</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Create a new session during user authentication to prevent session fixation attacks.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_19_jan_2021_105122_costin_zaharia_wrote">on 19 Jan 2021, 10:51:22 Costin Zaharia wrote:</h3>
<div class="paragraph">
<p>As far as I can tell this rule does not apply to <strong>ASP.Net</strong> and <strong>ASP.Net Core</strong> where the session id cannot be changed. According to <a href="https://owasp.org/www-community/controls/Session_Fixation_Protection">OWASP</a>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Unfortunately, some platforms, notably Microsoft ASP, do not generate new values for sessionid cookies, but rather just associate the existing value with a new session. This guarantees that almost all ASP apps will be vulnerable to session fixation, unless they have taken specific measures to protect against it.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>