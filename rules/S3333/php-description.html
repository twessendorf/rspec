<div class="paragraph">
<p>The <code>open_basedir</code> configuration in <em>php.ini</em> limits the files the script can access using, for example, <code>include</code> and <code>fopen()</code>. Leave it out, and there is no default limit, meaning that any file can be accessed. Include it, and PHP will refuse to access files outside the allowed path.</p>
</div>
<div class="paragraph">
<p><code>open_basedir</code> should be configured with a directory, which will then be accessible recursively. However, the use of <code>.</code> (current directory) as an <code>open_basedir</code> value should be avoided since it&#8217;s resolved dynamically during script execution, so a <code>chdir('/')</code> command could lay the whole server open to the script.</p>
</div>
<div class="paragraph">
<p>This is not a fool-proof configuration; it can be reset or overridden at the script level. But its use should be seen as a minimum due diligence step. This rule raises an issue when <code>open_basedir</code> is not present in <em>php.ini</em>, and when <code>open_basedir</code> contains root, or the current directory (<code>.</code>) symbol.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>; php.ini try 1
; open_basedir="${USER}/scripts/data"  Noncompliant; commented out

; php.ini try 2
open_basedir="/:${USER}/scripts/data"  ; Noncompliant; root directory in the list</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>; php.ini try 1
open_basedir="${USER}/scripts/data"</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/23.html">MITRE, CWE-23</a> - Relative Path Traversal</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/36.html">MITRE, CWE-36</a> - Absolute Path Traversal</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Set "open_basedir".</p>
</li>
<li>
<p>Limit "open_basedir" to a narrower path than "xxx".</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_075530_linda_martin_wrote">on 1 Sep 2015, 07:55:30 Linda Martin wrote:</h3>
<div class="paragraph">
<p>@Ann actually I just realised that comment in the php.ini file are defined as the following: "any text on a line after an unquoted semicolon (; ) is ignored" from documentation: see http://php.net/manual/en/configuration.file.php.</p>
</div>
<div class="paragraph">
<p>So shall we update the code snippet or not (for readability)?</p>
</div>
<div class="paragraph">
<p>Otherwise LGTM!</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_130823_ann_campbell_wrote">on 1 Sep 2015, 13:08:23 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Absolutely [~linda.martin]! Please always correct my syntax. :-]</p>
</div>
<div class="paragraph">
<p>I&#8217;ve made an update just now. Double-check it?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_nov_2015_174503_linda_martin_wrote">on 12 Nov 2015, 17:45:03 Linda Martin wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thanks, I update the remaining comments.</p>
</div>
</div>
</div>
</div>