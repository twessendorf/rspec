<div class="paragraph">
<p>When generating cryptographic keys (or key pairs), it is important to use strong parameters. Key length, for instance, should provide enough entropy against brute-force attacks.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>RSA</code> and <code>DSA</code> algorithms key size should be at least 2048 bits long</p>
</li>
<li>
<p>For <code>ECC</code> (elliptic curve cryptography) algorithms key size should be at least 224 bits long</p>
</li>
<li>
<p>For <code>RSA</code> public key exponent should be at least 65537.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule raises an issue when a <code>RSA</code>, <code>DSA</code> or <code>ECC</code> key-pair generator is initialized using weak parameters.</p>
</div>
<div class="paragraph">
<p>It supports the following libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/pyca/cryptography">cryptography</a></p>
</li>
<li>
<p><a href="https://github.com/dlitz/pycrypto">PyCrypto</a></p>
</li>
<li>
<p><a href="https://github.com/Legrandin/pycryptodome">Cryptodome</a></p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa

dsa.generate_private_key(key_size=1024, backend=backend) # Noncompliant
rsa.generate_private_key(public_exponent=999, key_size=2048, backend=backend) # Noncompliant
ec.generate_private_key(curve=ec.SECT163R2, backend=backend)  # Noncompliant</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa

dsa.generate_private_key(key_size=2048, backend=backend) # Compliant
rsa.generate_private_key(public_exponent=65537, key_size=2048, backend=backend) # Compliant
ec.generate_private_key(curve=ec.SECT409R1, backend=backend) # Compliant</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://www.ssi.gouv.fr/uploads/2014/11/RGS_v-2-0_B1.pdf">ANSSI RGSv2</a> - Référentiel Général de Sécurité version 2</p>
</li>
<li>
<p><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">NIST FIPS 186-4</a> - Digital Signature Standard (DSS)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/326.html">MITRE, CWE-326</a> - Inadequate Encryption Strength</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a key length of at least 'xxx' bits</p>
</div>
<div class="paragraph">
<p>Use a public key exponent of at least 65537</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s4787">deprecates: S4787</h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s4787">relates to: S4787</h3>

</div>
</div>
</div>