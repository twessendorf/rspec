<div class="paragraph">
<p>There can&#8217;t be any good reason to do a full table scan on large database tables due to the cost of such operation and the scalability issue that might raise. This rule raises an issue when a <code>SELECT</code> statement doesn&#8217;t use at least one indexed column in its <code>WHERE</code> clause.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong> That this rule raises issues only when a database catalog is provided during the SonarQube analysis.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>SELECT * FROM USERS WHERE NAME = :name  -- non compliant when NAME column is not indexed</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule ignores <code>SELECT</code> statements not having any <code>WHERE</code> clauses; they are covered by other rules: S1590, SQL.SelectWithNoWhereClauseCheck</p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add at least one criterion to the "WHERE" clause using an indexed column.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="ulist">
<ul>
<li>
<p>key = threshold</p>
</li>
<li>
<p>description: Ignore statements on tables with fewer than this many rows.</p>
</li>
<li>
<p>default: 1000</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>entire where clause</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s1956">deprecates: S1956</h3>

</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_161426_pierre_yves_nicolas_wrote">on 8 Jan 2016, 16:14:26 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>The current message seems to imply that this rule should only be triggered if a SQL statement has a WHERE clause. However, if there is no WHERE clause, no index can be used.</p>
</div>
<div class="paragraph">
<p>Please note that we already have other rules (with a noticeable difference: they have no "threshold" parameter):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSPEC-1590 for DELETE and UPDATE with no WHERE clause (with a default severity set to major)</p>
</li>
<li>
<p>RSPEC-1492 for SELECT with no WHERE clause (with a default severity set to critical)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_171924_ann_campbell_wrote">on 8 Jan 2016, 17:19:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas] if this rule raises an issue on a missing <code>WHERE</code> clause, we&#8217;ll get a double hit if RSPEC-1492 is also on (which is bad, IMO). But if we subsume RSPEC-1492 into this rule, then will <code>WHERE</code>-less <code>SELECT</code>s be found if no database information is available?</p>
</div>
<div class="paragraph">
<p>Regarding the differing severities of RSPEC-1590, and RSPEC-1492, <code>WHERE</code>-less <code>SELECT</code>s are widely regarded as security issues, but that&#8217;s not the case for <code>WHERE</code>-less <code>DELETE</code> and <code>UPDATE</code> statements. Unless I&#8217;m behind on my reading&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_174613_pierre_yves_nicolas_wrote">on 8 Jan 2016, 17:46:13 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m fine to exclude statements without WHERE clause from this rule: I think that the description should then mention RSPEC-1492 and RSPEC-1590, perhaps in the "See also" section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_jan_2016_183715_ann_campbell_wrote">on 11 Jan 2016, 18:37:15 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Done [~pierre-yves.nicolas] &amp; assigning back to [~freddy.mallet] for his initial review.</p>
</div>
</div>
</div>
</div>