<div class="paragraph">
<p>The <code>%s</code> placeholder is used to read a word into a string.</p>
</div>
<div class="paragraph">
<p>By default, there is no restriction on the length of that word, and the developer is required to pass a sufficiently large buffer for storing it.</p>
</div>
<div class="paragraph">
<p>No matter how large the buffer is, there will always be a longer word.</p>
</div>
<div class="paragraph">
<p>Therefore, programs relying on <code>%s</code> are vulnerable to buffer overflows.</p>
</div>
<div class="paragraph">
<p>A field width specifier can be used together with the <code>%s</code> placeholder to limit the number of bytes which will by written to the buffer.</p>
</div>
<div class="paragraph">
<p>Note that an additional byte is required to store the null terminator.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>char buffer[10];
scanf("%s", buffer);      // Noncompliant - will overflow when a word longer than 9 characters is entered</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>char buffer[10];
scanf("%9s", buffer);     // Compliant - will not overflow</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> - Using Components with Known Vulnerabilities</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/120.html">MITRE, CWE-120</a> - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/676.html">MITRE, CWE-676</a> - Use of Potentially Dangerous Function</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add a field width specifier to this "%s" placeholder.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_093716_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 09:37:16 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>See http://msdn.microsoft.com/en-us/library/xdb9w69d.aspx</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_063819_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 06:38:19 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>perhaps we should also cover sscanf() and fscanf()</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_081236_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 08:12:36 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p><a href="http://crasseux.com/books/ctutorial/String-overflows-with-scanf.html" class="bare">http://crasseux.com/books/ctutorial/String-overflows-with-scanf.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_093741_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 09:37:41 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Let&#8217;s exclude sscanf() because the length of the string is known by the program, and is an upper bound for the size of the buffer required by %s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2015_094930_samuel_mercier_wrote">on 3 Mar 2015, 09:49:30 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] added reference to MITRE, CWE-676 for consistency with RSPEC-1081. Can you double check?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2015_144316_samuel_mercier_wrote">on 3 Mar 2015, 14:43:16 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>Answer from Ann on hipchat on March 3rd, 2014, 14:31 looks good @SamuelMercier . Thx</p>
</div>
</div>
</div>
</div>