<div class="paragraph">
<p>Web applicaitons that send redirects should neutralize any values taken from a request before using them in redirects. Failing to do so could make it easier for attackers to launch phishing attacks from your site.</p>
</div>
<div class="paragraph">
<p>This rule checks that values extracted from a request are not unconditionally used directly in a redirect or other header fields.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>protected void doGet(HttpServletRequest request, HttpServletResponse response)
      throws ServletException, IOException {
  // ...
  String url = request.getParameter("url");
  response.sendRedirect(url);  // Noncompliant; request value used directly in redirect</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>protected void doGet(HttpServletRequest request, HttpServletResponse response)
      throws ServletException, IOException {
  // ...
  String url = request.getParameter("url");
  if (url.matches(OKAY_URL_REGEX)) {
    response.sendRedirect(url);  // Compliant; value used conditionally
  }</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>protected void doGet(HttpServletRequest request, HttpServletResponse response)
      throws ServletException, IOException {
  // ...
  String url = request.getParameter("url");
  response.sendRedirect(scrubRedirect(url));  // Compliant; method presumed to sanitize input</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site Scripting (XSS)</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/601.html">MITRE, CWE-601</a> - URL Redirection to Untrusted Site</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components</p>
</li>
<li>
<p>Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#UNVALIDATED_REDIRECT">Unvalidated Redirect</a></p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>"xxx" is taken from the request parameters and not sanitized before use.</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_082549_nicolas_peru_wrote">on 8 Oct 2014, 08:25:49 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Will probably be easier with CFG.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_feb_2015_211716_sébastien_gioria_wrote">on 2 Feb 2015, 21:17:16 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>As I&#8217;m OK with the OWASP Top10 2013 A1 Classification. This vulnerability is typically a HTTP Request Splitting Vulnerability (WASC-24) and this is categorize to OWASP Top10 2013 A3 XSS.</p>
</div>
<div class="paragraph">
<p>Could it be possible to assign a Rules to 2 differents owasp-top10 tags ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_204306_ann_campbell_wrote">on 3 Feb 2015, 20:43:06 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I have no problem mapping this to multiple OWASP categories [~sebastien.gioria] :-)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_jul_2015_074736_ann_campbell_wrote">on 20 Jul 2015, 07:47:36 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Tagged java-top by Ann</p>
</div>
</div>
</div>
</div>