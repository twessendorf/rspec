<div class="paragraph">
<p>When relying on the password authentication mode for the database connection, a secure password should be chosen.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when an empty password is used.</p>
</div>
<div class="sect1">
<h2 id="_noncompliant_code_example">Noncompliant Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>Connection conn = DriverManager.getConnection("jdbc:derby:memory:myDB;create=true", "login", "");</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>String password = System.getProperty("database.password");
Connection conn = DriverManager.getConnection("jdbc:derby:memory:myDB;create=true", "login", password);</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and Authentication Failures</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken Authentication</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/521.html">MITRE, CWE-521</a> - Weak Password Requirements</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a secure password when connecting to this database.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary: The whole function call to {code}DriverManager.getConnection(&#8230;&#8203;){code}</p>
</li>
<li>
<p>Secondary: if the password is a variable, highlight the value assigned to this variable.</p>
<div class="ulist">
<ul>
<li>
<p>message: "Empty password value."</p>
</li>
<li>
<p>message: "URL containing the empty password."</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_16_aug_2018_110629_nicolas_harraudeau_wrote">on 16 Aug 2018, 11:06:29 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>In order to avoid False Positives this rule will limit its detection when the only parameter is the "URL", i.e. <code>DriverManager.getConnection("jdbc:...")</code></p>
</div>
<div class="paragraph">
<p>The rule then focuses on empty passwords. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> DriverManager.getConnection"jdbc:mysql://localhost/test?user=fred&amp;password="); // empty password, detected
 DriverManager.getConnection"jdbc:mysql://localhost/test?user=fred"); // no password, not detected</pre>
</div>
</div>
<div class="paragraph">
<p>The reason is that there are many different formats to provide a password in a JDBC connection string and it would create many False Positive to match only some of them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_071442_nicolas_peru_wrote">on 8 Oct 2014, 07:14:42 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] Ok for this rule in java, to detect cases such as the noncompliant one. Should such rule also be extended to check some of the classical JEE xml configuration files (using the XML plugin then) ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2014_190817_freddy_mallet_wrote">on 12 Oct 2014, 19:08:17 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann I would make this rule also covering Findbugs rule DMI_CONSTANT_DB_PASSWORD. The title could then become :</p>
</div>
<div class="paragraph">
<p>"Databases should be password-protected and password should not be hardcoded"</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_143218_ann_campbell_wrote">on 14 Oct 2014, 14:32:18 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] I had already defined RSPEC-2068 for that, and the reasonings are slightly different. Do you still want me to combine them?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_210815_freddy_mallet_wrote">on 14 Oct 2014, 21:08:15 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Ok fine [~ann.campbell.2]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_jan_2015_085612_sébastien_gioria_wrote">on 16 Jan 2015, 08:56:12 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>Could be tag OWASP Top10. A6-Security Misconfiguration</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_jan_2015_084526_ann_campbell_wrote">on 19 Jan 2015, 08:45:26 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria], done!</p>
</div>
</div>
</div>
</div>