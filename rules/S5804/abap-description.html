<div class="paragraph">
<p>User enumeration refers to the ability to guess existing usernames in a web application database. This can happen, for example, when using "sign-in/sign-on/forgot password" functionalities of a website.</p>
</div>
<div class="paragraph">
<p>When an user tries to "sign-in" to a website with an incorrect username/login, the web application should not disclose that the username doesn&#8217;t exist with a message similar to "this username is incorrect", instead a generic message should be used like "bad credentials", this way it&#8217;s not possible to guess whether the username or password was incorrect during the authentication.</p>
</div>
<div class="paragraph">
<p>If a user-management feature discloses information about the existence of a username, attackers can use brute force attacks to retrieve a large amount of valid usernames that will impact the privacy of corresponding users and facilitate other attacks (phishing, password guessing etc &#8230;&#8203;).</p>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The application discloses that a username exists in its database: most of the time it&#8217;s possible to avoid this kind of leak except for the "registration/sign-on" part of a website because in this case the user must choose a valid username (not already taken by another user).</p>
</li>
<li>
<p>There is no rate limiting and CAPTCHA protection in place for requests involving a username.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a user performs a request involving a username, it should not be possible to spot differences between a valid and incorrect username:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Error messages should be generic and not disclose if the username is valid or not.</p>
</li>
<li>
<p>The response time must be similar for a valid username or not.</p>
</li>
<li>
<p>CAPTCHA and other rate limiting solutions should be implemented.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/200.html">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure allowing user enumeration is safe here.</p>
</div>
</div>
</div>
</div>