<div class="paragraph">
<p>Hardcoding a URI makes it difficult to test a program: path literals are not always portable across operating systems, a given absolute path may not exist on a specific test environment, a specified Internet URL may not be available when executing the tests, production environment filesystems usually differ from the development environment, &#8230;&#8203;etc. For all those reasons, a URI should never be hardcoded. Instead, it should be replaced by customizable parameter.</p>
</div>
<div class="paragraph">
<p>Further even if the elements of a URI are obtained dynamically, portability can still be limited if the path-delimiters are hardcoded.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when URI&#8217;s or path delimiters are hardcoded.</p>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule does not raise an issue when an ASP.NET virtual path is passed as an argument to one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>methods: <code>System.Web.HttpServerUtilityBase.MapPath()</code>, <code>System.Web.HttpRequestBase.MapPath()</code>, <code>System.Web.HttpResponseBase.ApplyAppPathModifier()</code>, <code>System.Web.Mvc.UrlHelper.Content()</code></p>
</li>
<li>
<p>all methods of: <code>System.Web.VirtualPathUtility</code></p>
</li>
<li>
<p>constructors of: <code>Microsoft.AspNetCore.Mvc.VirtualFileResult</code>, <code>Microsoft.AspNetCore.Routing.VirtualPathData</code></p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Refactor your code not to use hardcoded absolute paths or URIs.</p>
</li>
<li>
<p>Remove this hardcoded path-delimiter.</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_13_jul_2017_104959_amaury_levé_wrote">on 13 Jul 2017, 10:49:59 Amaury Levé wrote:</h3>
<div class="paragraph">
<p>Test classes are ignored for C#.</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s2117">is duplicated by: S2117</h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s1829">relates to: S1829</h3>

</div>
<div class="sect2">
<h3 id="_on_5_jun_2013_131855_fabrice_bellingard_wrote">on 5 Jun 2013, 13:18:55 Fabrice Bellingard wrote:</h3>
<div class="paragraph">
<p>The strings that should be detected are any kind of absolute or OS-specific URI - but not relative ones. For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>should be detected:</p>
<div class="ulist">
<ul>
<li>
<p>Strings starting with an <a href="http://en.wikipedia.org/wiki/URI_scheme">URI scheme</a>:</p>
<div class="ulist">
<ul>
<li>
<p>http://www.mywebsite.com</p>
</li>
<li>
<p><a href="ftp://myserver.com" class="bare">ftp://myserver.com</a></p>
</li>
<li>
<p>file:/my/folder</p>
</li>
<li>
<p>&#8230;&#8203;etc</p>
</li>
</ul>
</div>
</li>
<li>
<p>//my-network-drive</p>
</li>
<li>
<p>C:/my/folder</p>
</li>
<li>
<p>/my/other/folder</p>
</li>
<li>
<p>~/my/local/folder</p>
</li>
</ul>
</div>
</li>
<li>
<p>should NOT be detected:</p>
<div class="ulist">
<ul>
<li>
<p>my/folder</p>
</li>
<li>
<p>./my/folder</p>
</li>
<li>
<p>../my/folder</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_feb_2015_204746_sébastien_gioria_wrote">on 2 Feb 2015, 20:47:46 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>CERT MSC03-J</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_203401_ann_campbell_wrote">on 3 Feb 2015, 20:34:01 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>thanks [~sebastien.gioria]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_10_apr_2015_183239_ann_campbell_wrote">on 10 Apr 2015, 18:32:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I&#8217;m assigning this rule update to you for verification [~elena.vilchik], since you&#8217;re the only one to have implemented it so far.</p>
</div>
<div class="paragraph">
<p>Note that I&#8217;ve already entered SWIFT-108 to update Swift implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_jun_2017_110923_amaury_levé_wrote">on 30 Jun 2017, 11:09:23 Amaury Levé wrote:</h3>
<div class="paragraph">
<p>There is no link to FxCop, could you add it?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_jun_2017_135521_jean_christophe_collet_wrote">on 30 Jun 2017, 13:55:21 Jean-Christophe Collet wrote:</h3>
<div class="paragraph">
<p>Done</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2018_171104_elena_vilchik_wrote">on 28 Aug 2018, 17:11:04 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>I&#8217;ve set JS and TS as irrelevant for this rule, as it&#8217;s common practice to hardcode urls (e.g. for API endpoints). Even if sometimes the rule might be relevant, still ROI is low (rule has low value and implementation is not super trivial)</p>
</div>
</div>
</div>
</div>