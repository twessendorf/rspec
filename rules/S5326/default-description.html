<div class="paragraph">
<p>Validating SSL/TLS connections is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2014-5531">CVE-2014-5531</a></p>
</li>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2014-5524">CVE-2014-5524</a></p>
</li>
<li>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2014-5574">CVE-2014-5574</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SSL/TLS protocols encrypt network connections. The server usually provides a digital certificate to prove its identity. Accepting all SSL/TLS certificates makes your application vulnerable to Man-in-the-middle attacks (MITM).</p>
</div>
<div class="paragraph">
<p>This rule will raise an issue when a method named <code>onReceivedSslError</code> with first argument of type <code>android.webkit.WebView</code> is defined.</p>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>invalid SSL/TLS certificates are accepted automatically.</p>
</li>
<li>
<p>The user is asked to accept invalid SSL/TLS certificates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You are at risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Accept only trusted SSL/TLS certificates.</p>
</li>
<li>
<p>Do not ask users to accept unsafe connections as they are unlikely to make an informed security decision.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Android (See also <a href="https://support.google.com/faqs/answer/7071387?hl=en">"How to address WebView SSL Error Handler alerts in your apps."</a>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>package com.example.myapplication.rspec_5326;

import android.net.http.SslError;
import android.os.Build;
import android.support.annotation.RequiresApi;
import android.webkit.SslErrorHandler;
import android.webkit.WebView;
import android.webkit.WebViewClient;

import java.util.function.Function;

public class SSLTLSValidation extends WebViewClient {
    private final Function&lt;SslError, Boolean&gt; acceptSslError;

    SSLTLSValidation(Function&lt;SslError, Boolean&gt; acceptSslError) {
        this.acceptSslError = acceptSslError;
    }

    @RequiresApi(api = Build.VERSION_CODES.N)
    @Override
    public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) { // Sensitive
        if (acceptSslError.apply(error)) {
            handler.proceed();
        } else {
            handler.cancel();
        }
    }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security Misconfiguration</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/295.html">MITRE, CWE-295</a> - Improper Certificate Validation</p>
</li>
<li>
<p><a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses</p>
</li>
</ul>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that SSL/TLS connections are validated safely here</p>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_2_apr_2019_113757_nicolas_harraudeau_wrote">on 2 Apr 2019, 11:37:57 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>We could define a vulnerability rule as many projects on Github have just <code>handler.proceed();</code> in <code>onReceivedSslError</code>. But the usefulness of such a rule might be limited as it seems that <a href="https://support.google.com/faqs/answer/7071387?hl=en">Google validates the plugins</a>. We should first check if Google is able to detect every simple case.</p>
</div>
</div>
</div>
</div>